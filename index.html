<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Dokumentacja kodu VBA</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1a5749eb-6be7-80be-b1db-c478a49b6aba" class="page sans"><header><h1 class="page-title"><strong>Dokumentacja kodu VBA</strong></h1><p class="page-description"></p></header><div class="page-body"><h2 id="1a5749eb-6be7-80fe-83d7-d805177a8076" class=""><strong>Opis skryptu</strong></h2><p id="1a5749eb-6be7-804d-b5fe-cdac022f900e" class="">Skrypt w języku VBA importuje dane z dwóch plików Excel, wykonuje zapytanie SQL w celu pobrania danych z bazy, a następnie łączy te dane w arkuszu Excel. W wyniku powstaje nowy arkusz „Wynik”, który zawiera scalone dane z obu plików Excel oraz bazy SQL. Na koniec dane są dzielone na osobne arkusze na podstawie wartości w określonej kolumnie.</p><hr id="1a5749eb-6be7-8032-810d-e43c17923092"/><h2 id="1a5749eb-6be7-8030-a955-e98c34fe80b2" class=""><strong>Opis zmiennych</strong></h2><ul id="1a5749eb-6be7-804f-bb3e-d0827ca1b377" class="bulleted-list"><li style="list-style-type:disc"><strong>conn, rs</strong> – Obiekty do obsługi połączenia z bazą SQL i wyników zapytania.</li></ul><ul id="1a5749eb-6be7-80b7-8172-f4f864d0212c" class="bulleted-list"><li style="list-style-type:disc"><strong>sqlQuery</strong> – String przechowujący zapytanie SQL.</li></ul><ul id="1a5749eb-6be7-8000-93c6-ee9588e57ec3" class="bulleted-list"><li style="list-style-type:disc"><strong>wsData1, wsData2, wsResult</strong> – Arkusze przechowujące dane wejściowe i wynikowe.</li></ul><ul id="1a5749eb-6be7-8047-be6b-ea99b0e139f9" class="bulleted-list"><li style="list-style-type:disc"><strong>filePath1, filePath2</strong> – Ścieżki do plików Excel.</li></ul><ul id="1a5749eb-6be7-80a5-b266-c3a4297932e5" class="bulleted-list"><li style="list-style-type:disc"><strong>row, col</strong> – Liczniki iteracyjne dla wierszy i kolumn.</li></ul><ul id="1a5749eb-6be7-805c-b82f-f662a82343fc" class="bulleted-list"><li style="list-style-type:disc"><strong>sqlColumns, excelColumns</strong> – Liczba kolumn w danych SQL i Excel.</li></ul><ul id="1a5749eb-6be7-80b9-b404-f2d92ef357f1" class="bulleted-list"><li style="list-style-type:disc"><strong>excelColumnID, excelColumnCase1, excelColumnCase2</strong> – Indeksy odpowiednich kolumn.</li></ul><ul id="1a5749eb-6be7-801f-a171-dd92dc393537" class="bulleted-list"><li style="list-style-type:disc"><strong>dictSQL, dictExcel</strong> – Słowniki przechowujące dane SQL i Excel dla szybkiego dostępu.</li></ul><ul id="1a5749eb-6be7-806d-b267-fd9d191d283d" class="bulleted-list"><li style="list-style-type:disc"><strong>fieldValues, fieldValuesExcel</strong> – Tablice przechowujące wartości pól.</li></ul><ul id="1a5749eb-6be7-80e2-8172-e145940aec04" class="bulleted-list"><li style="list-style-type:disc"><strong>dropColumns</strong> – Tablica kolumn do usunięcia.</li></ul><ul id="1a5749eb-6be7-80e2-ab29-f465a2268533" class="bulleted-list"><li style="list-style-type:disc"><strong>columnToDrop</strong> – Nazwa kolumny do usunięcia.</li></ul><hr id="1a5749eb-6be7-80b7-9a12-f2e7430fd2a5"/><h2 id="1a5749eb-6be7-80b2-9b41-ffb93f4d07ed" class=""><strong>Schemat komunikacji między blokami kodu</strong></h2><ol type="1" id="1a5749eb-6be7-8067-86bb-d1a7a7f3b158" class="numbered-list" start="1"><li>Użytkownik wybiera dwa pliki Excel.</li></ol><ol type="1" id="1a5749eb-6be7-80db-a053-f27d1a22213e" class="numbered-list" start="2"><li>Skrypt importuje dane z plików Excel do tymczasowych arkuszy.</li></ol><ol type="1" id="1a5749eb-6be7-8003-a630-e50524356e58" class="numbered-list" start="3"><li>Otwierane jest połączenie z bazą SQL i pobierane są dane.</li></ol><ol type="1" id="1a5749eb-6be7-8044-8793-fbc20a66df0c" class="numbered-list" start="4"><li>Dane SQL i Excel są przechowywane w słownikach.</li></ol><ol type="1" id="1a5749eb-6be7-804f-ac8e-f0c6a2716b25" class="numbered-list" start="5"><li>Tworzony jest arkusz „Wynik” i kopiowane są do niego dane.</li></ol><ol type="1" id="1a5749eb-6be7-8083-b739-f3ec581e168b" class="numbered-list" start="6"><li>Przeprowadzana jest operacja LEFT JOIN na danych z plików Excel i bazy SQL.</li></ol><ol type="1" id="1a5749eb-6be7-80ce-a057-f5b39565b88a" class="numbered-list" start="7"><li>Niepotrzebne kolumny są usuwane.</li></ol><ol type="1" id="1a5749eb-6be7-80ac-a7b7-faa87d001308" class="numbered-list" start="8"><li>Dane są dzielone na osobne arkusze na podstawie wartości w wybranej kolumnie.</li></ol><ol type="1" id="1a5749eb-6be7-8045-ace5-fe4e9e913611" class="numbered-list" start="9"><li>Po zakończeniu przetwarzania połączenie SQL jest zamykane i pamięć zwalniana.</li></ol><hr id="1a5749eb-6be7-80ba-a5c7-dd1cee63e775"/><h2 id="1a5749eb-6be7-8055-8028-e5b542e4b07f" class=""><strong>Opis funkcji</strong></h2><ol type="1" id="1a5749eb-6be7-80ea-a910-d1e301e46213" class="numbered-list" start="1"><li><strong>GetFilePath()</strong> – Otwiera okno dialogowe do wyboru pliku Excel.</li></ol><ol type="1" id="1a5749eb-6be7-808d-9af0-cae63184ea83" class="numbered-list" start="2"><li><strong>ImportExcelData(filePath)</strong> – Importuje dane z pliku Excel do tymczasowego arkusza.</li></ol><ol type="1" id="1a5749eb-6be7-8069-bdf7-d773bda69ba7" class="numbered-list" start="3"><li><strong>FindColumn(ws, columnName)</strong> – Znajduje numer kolumny na podstawie jej nazwy.</li></ol><ol type="1" id="1a5749eb-6be7-80d3-bd01-e062a1b20570" class="numbered-list" start="4"><li><strong>ConvertToSafeKey(value)</strong> – Konwertuje wartość na klucz bezpieczny dla słowników.</li></ol><hr id="1a5749eb-6be7-809e-be6e-c2462dd43edf"/><h2 id="1a5749eb-6be7-8091-be1f-eeee1fe97564" class=""><strong>Możliwe problemy i ich rozwiązania</strong></h2><ol type="1" id="1a5749eb-6be7-8040-9de9-efd1b6b66349" class="numbered-list" start="1"><li><strong>Brak wybranego pliku Excel</strong> – Skrypt kończy działanie, jeśli użytkownik nie wskaże pliku.</li></ol><ol type="1" id="1a5749eb-6be7-8047-aead-db600b0b0b88" class="numbered-list" start="2"><li><strong>Brak wymaganych kolumn w plikach Excel</strong> – Użytkownik otrzymuje komunikat o błędzie.</li></ol><ol type="1" id="1a5749eb-6be7-80b7-84b0-dd5ed0bdfc89" class="numbered-list" start="3"><li><strong>Problemy z połączeniem SQL</strong> – Sprawdzić konfigurację DSN i dostęp do bazy.</li></ol><ol type="1" id="1a5749eb-6be7-80eb-8294-ec32647c789c" class="numbered-list" start="4"><li><strong>Brak dopasowań między danymi SQL i Excel</strong> – Możliwe błędy w nazwach kolumn lub różnice w formacie danych.</li></ol><ol type="1" id="1a5749eb-6be7-80cd-8fb4-d195a91bcf60" class="numbered-list" start="5"><li><strong>Wolne działanie przy dużych zbiorach danych</strong> – Można zoptymalizować przez zmniejszenie liczby przetwarzanych kolumn lub filtrowanie danych przed importem.</li></ol><hr id="1a5749eb-6be7-80eb-8e11-f267e61bf54a"/><p id="1a5749eb-6be7-80aa-a78b-edc0560c2b7b" class="">
</p><h2 id="1a5749eb-6be7-8081-8052-c38ef5cdb930" class=""><strong>Krok po kroku – analiza kodu</strong></h2><h2 id="1a5749eb-6be7-8066-a745-f16f214408bd" class=""><strong>Analiza kodu krok po kroku</strong></h2><h3 id="1a5749eb-6be7-80db-abf5-e75e2e98098e" class=""><strong>1. Deklaracja zmiennych</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8073-8c11-fecf70e1f739" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Dim conn As Object
Dim rs As Object
Dim sqlQuery As String
Dim wsData1 As Worksheet, wsData2 As Worksheet, wsResult As Worksheet
Dim filePath1 As String, filePath2 As String
Dim row As Long, col As Long
Dim sqlColumns As Long, excelColumns As Long
Dim excelColumnID As Long, excelColumnCase1 As Long, excelColumnCase2 As Long
Dim dictSQL As Object, dictExcel As Object
Dim excelKey As String, sqlKey As String, caseKey As String
Dim fieldValues() As Variant, fieldValuesExcel() As Variant
Dim lastColumn As Long, lastColumnExcel As Long
Dim dropColumns As Variant, colIndex As Integer
Dim columnToDrop As String
</code></pre><p id="1a5749eb-6be7-809d-a486-e5706579461c" class="">W tym bloku kodu deklarowane są zmienne, które będą wykorzystywane w dalszej części skryptu.</p><ul id="1a5749eb-6be7-80a2-bf90-d8f16d7eb209" class="bulleted-list"><li style="list-style-type:disc"><strong>Obiekty połączenia do SQL (</strong><code><strong>conn</strong></code><strong>, </strong><code><strong>rs</strong></code><strong>)</strong> – pozwalają na interakcję z bazą danych.</li></ul><ul id="1a5749eb-6be7-80c0-9ea0-ca396f6d2ff6" class="bulleted-list"><li style="list-style-type:disc"><strong>Obiekty arkuszy (</strong><code><strong>wsData1</strong></code><strong>, </strong><code><strong>wsData2</strong></code><strong>, </strong><code><strong>wsResult</strong></code><strong>)</strong> – przechowują dane wejściowe oraz wynik.</li></ul><ul id="1a5749eb-6be7-8057-8bd8-ddb7f3fe52a6" class="bulleted-list"><li style="list-style-type:disc"><strong>Słowniki (</strong><code><strong>dictSQL</strong></code><strong>, </strong><code><strong>dictExcel</strong></code><strong>)</strong> – przechowują wczytane dane, aby łatwo je wyszukiwać.</li></ul><ul id="1a5749eb-6be7-8027-8cfe-d2f6d1a8b6fc" class="bulleted-list"><li style="list-style-type:disc"><strong>Tablice (</strong><code><strong>fieldValues</strong></code><strong>, </strong><code><strong>fieldValuesExcel</strong></code><strong>)</strong> – przechowują wartości kolumn.</li></ul><hr id="1a5749eb-6be7-806e-8181-f011b9837044"/><h3 id="1a5749eb-6be7-8031-a6d6-ee2b595e773b" class=""><strong>2. Wybór plików Excel</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8025-a0ca-d03814fc6065" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">filePath1 = GetFilePath(&quot;Wybierz pierwszy plik Excel&quot;)
If filePath1 = &quot;&quot; Then Exit Sub
filePath2 = GetFilePath(&quot;Wybierz drugi plik Excel&quot;)
If filePath2 = &quot;&quot; Then Exit Sub</code></pre><ul id="1a5749eb-6be7-8010-bac6-df1a5ce6e038" class="bulleted-list"><li style="list-style-type:disc">Użytkownik wybiera dwa pliki Excel. Jeśli nie wybierze pliku, skrypt kończy działanie.</li></ul><hr id="1a5749eb-6be7-806c-a9ed-f25f865d7aff"/><h3 id="1a5749eb-6be7-8097-8b9a-d1cbb0ceefb1" class=""><strong>3. Importowanie danych z plików Excel</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80c2-a423-cc0553a5bbc2" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set wsData1 = ImportExcelData(filePath1)
Set wsData2 = ImportExcelData(filePath2)
</code></pre><ul id="1a5749eb-6be7-804f-aab2-dd0c7811751e" class="bulleted-list"><li style="list-style-type:disc">Importuje dane z wybranych plików Excel do arkuszy tymczasowych.</li></ul><hr id="1a5749eb-6be7-8032-84d2-ebf07f1fe198"/><h3 id="1a5749eb-6be7-8025-b615-c50e3c16628a" class=""><strong>4. Połączenie z bazą SQL i pobranie danych</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8070-a7cf-c95916fd421f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set conn = CreateObject(&quot;ADODB.Connection&quot;)
conn.Open &quot;DSN=&lt;path_name&gt;;&quot;
sqlQuery = &quot;SELECT ID_KLIENTA_BAZA, Kolumna1, Kolumna2, Kolumna3 FROM your_table&quot;
Set rs = conn.Execute(sqlQuery)
</code></pre><ul id="1a5749eb-6be7-80f8-9b9e-d59f94e443fe" class="bulleted-list"><li style="list-style-type:disc">Otwiera połączenie z bazą SQL i wykonuje zapytanie, pobierając dane.</li></ul><hr id="1a5749eb-6be7-802d-95a8-c9ee9b891fbc"/><h3 id="1a5749eb-6be7-801f-a28f-ccd0b4436a84" class=""><strong>5. Wczytanie danych SQL do słownika</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80d5-8bb6-c4084242eb17" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set dictSQL = CreateObject(&quot;Scripting.Dictionary&quot;)
Do While Not rs.EOF
    sqlKey = ConvertToSafeKey(rs.Fields(&quot;ID_KLIENTA_BAZA&quot;).Value)
    ReDim fieldValues(1 To sqlColumns - 1)
    For col = 1 To sqlColumns - 1
        fieldValues(col) = rs.Fields(col).Value
    Next col
    dictSQL(sqlKey) = fieldValues
    rs.MoveNext
Loop
</code></pre><p id="1a5749eb-6be7-800b-bb14-f63a5a264b0a" class="">Pobrane dane SQL są przechowywane w słowniku, gdzie kluczem jest <code>ID_KLIENTA_BAZA</code>.</p><h3 id="1a5749eb-6be7-8034-978a-edc4a0188ca1" class=""><strong>6. Wczytanie danych z drugiego pliku Excel do słownika</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8009-af57-feefc62c73a0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set dictExcel = CreateObject(&quot;Scripting.Dictionary&quot;)
excelColumnCase2 = FindColumn(wsData2, &quot;CASE_ID_Excel2&quot;)
excelColumns = wsData2.Cells(1, Columns.Count).End(xlToLeft).Column

row = 2
Do While wsData2.Cells(row, excelColumnCase2).Value &lt;&gt; &quot;&quot;
    caseKey = ConvertToSafeKey(wsData2.Cells(row, excelColumnCase2).Value)
    ReDim fieldValuesExcel(1 To excelColumns - 1)
    For col = 1 To excelColumns - 1
        fieldValuesExcel(col) = wsData2.Cells(row, col).Value
    Next col
    dictExcel(caseKey) = fieldValuesExcel
    row = row + 1
Loop
</code></pre><p id="1a5749eb-6be7-8020-a8fb-d23944e8241f" class="">Dane z drugiego pliku Excel są przechowywane w słowniku, gdzie kluczem jest <code>CASE_ID_Excel2</code>.</p><h3 id="1a5749eb-6be7-8068-a16a-ed4ace6400c8" class=""><strong>7. Tworzenie arkusza „Wynik”</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8000-b5cf-da4fc83a9f12" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">On Error Resume Next
Set wsResult = ThisWorkbook.Sheets(&quot;Wynik&quot;)
If wsResult Is Nothing Then
    Set wsResult = ThisWorkbook.Sheets.Add
    wsResult.Name = &quot;Wynik&quot;
End If
On Error GoTo 0
wsResult.Cells.Clear
wsData1.Cells.Copy wsResult.Cells(1, 1)
</code></pre><p id="1a5749eb-6be7-804b-bbf6-e7e2c1f8b4c2" class="">Tworzony jest arkusz „Wynik”, jeśli wcześniej nie istniał. Następnie dane są kopiowane.</p><h3 id="1a5749eb-6be7-803a-a535-e8bd4348ca52" class=""><strong>8. Wstawienie nagłówków danych SQL i Excel</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80c5-85e1-e5cc7e1788cb" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">For col = 1 To sqlColumns - 1
    wsResult.Cells(1, lastColumn + col).Value = rs.Fields(col).Name
Next col

For col = 1 To lastColumnExcel - 1
    wsResult.Cells(1, lastColumn + sqlColumns + col).Value = wsData2.Cells(1, col).Value
Next col
</code></pre><p id="1a5749eb-6be7-80a5-bd87-ce7280088b31" class="">Nagłówki kolumn z SQL i drugiego pliku Excel są wstawiane do arkusza „Wynik”.</p><h3 id="1a5749eb-6be7-8048-9fb0-d60792d28cfb" class=""><strong>9. LEFT JOIN – Łączenie danych</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8009-9a1f-e6a00a080d61" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">row = 2
Do While wsResult.Cells(row, excelColumnID).Value &lt;&gt; &quot;&quot; And row &lt; 1048576
    excelKey = ConvertToSafeKey(wsResult.Cells(row, excelColumnID).Value)
    caseKey = ConvertToSafeKey(wsResult.Cells(row, excelColumnCase1).Value)
</code></pre><p id="1a5749eb-6be7-80d8-9ecc-eb9af60e034d" class="">Dane SQL i Excel są łączone według ID klienta i CASE_ID.</p><h3 id="1a5749eb-6be7-8030-a1f7-d1e4e94fa079" class=""><strong>10. Podział wyników na arkusze</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-8087-9788-cd6c48c02d28" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Dim columnForSplit As Long
columnForSplit = FindColumn(wsResult, &quot;column_for_split&quot;)
If columnForSplit = 0 Then
    MsgBox &quot;Nie znaleziono kolumny &#x27;column_for_split&#x27; w arkuszu Wynik!&quot;, vbCritical
    Exit Sub
End If</code></pre><ul id="1a5749eb-6be7-8094-a3c3-d6449756d558" class="bulleted-list"><li style="list-style-type:disc">Sprawdza, czy kolumna według której dzielone będą dane, istnieje w arkuszu wynikowym.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-806e-abcc-df882c8d42dc" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Dim dictSheets As Object
Set dictSheets = CreateObject(&quot;Scripting.Dictionary&quot;)
row = 2
Do While wsResult.Cells(row, columnForSplit).Value &lt;&gt; &quot;&quot;
    Dim sheetName As String
    sheetName = Trim(wsResult.Cells(row, columnForSplit).Value)

    If Not dictSheets.exists(sheetName) Then
        Dim newSheet As Worksheet
        Set newSheet = ThisWorkbook.Sheets.Add
        newSheet.Name = sheetName
        Set dictSheets(sheetName) = newSheet
        wsResult.Rows(1).Copy newSheet.Rows(1)
    End If

    wsResult.Rows(row).Copy dictSheets(sheetName).Rows(dictSheets(sheetName).Cells(Rows.Count, 1).End(xlUp).Row + 1)
    row = row + 1
Loop
</code></pre><ul id="1a5749eb-6be7-8041-bfa7-e9efa0d669cb" class="bulleted-list"><li style="list-style-type:disc">Tworzy osobne arkusze dla każdej unikalnej wartości w kolumnie „column_for_split”.</li></ul><ul id="1a5749eb-6be7-8023-b39b-c3479d9b7fc0" class="bulleted-list"><li style="list-style-type:disc">Kopiuje odpowiednie wiersze do nowych arkuszy.</li></ul><hr id="1a5749eb-6be7-803f-9938-c9b7691beeb7"/><h3 id="1a5749eb-6be7-8096-9bde-f4d0a8cf94fc" class=""><strong>11. Zamknięcie połączenia</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80e3-92bb-d2d00f62dc50" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">rs.Close
conn.Close
Set rs = Nothing
Set conn = Nothing
Set dictSQL = Nothing
Set dictExcel = Nothing
</code></pre><p id="1a5749eb-6be7-8075-8fcc-e29304473ef5" class="">Na końcu zamykane jest połączenie do bazy oraz zwalniana jest pamięć.</p><h2 id="1a5749eb-6be7-80d7-9432-f95032c9fa44" class=""><strong>Funkcje pomocnicze</strong></h2><h3 id="1a5749eb-6be7-801d-8d0c-ee37544f77b7" class=""><strong>GetFilePath()</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-809e-8d7b-f92f2ad74b89" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Function GetFilePath() As String
</code></pre><ul id="1a5749eb-6be7-8068-85ef-df10a60fe635" class="bulleted-list"><li style="list-style-type:disc">Otwiera okno dialogowe do wyboru pliku Excel.</li></ul><ul id="1a5749eb-6be7-80de-8d72-c421bb6d3aba" class="bulleted-list"><li style="list-style-type:disc">Zwraca pełną ścieżkę do pliku lub pusty string, jeśli użytkownik anulował wybór.</li></ul><hr id="1a5749eb-6be7-803f-81ee-e37d3a8e3742"/><h3 id="1a5749eb-6be7-8025-bed0-ce6cb305375e" class=""><strong>ImportExcelData(filePath)</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-802a-98a7-e149d638d4ad" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Function ImportExcelData(filePath As String) As Worksheet
</code></pre><ul id="1a5749eb-6be7-80ad-9c42-fa44207c5f7d" class="bulleted-list"><li style="list-style-type:disc">Importuje plik Excel do arkusza tymczasowego.</li></ul><ul id="1a5749eb-6be7-802b-a7c6-cd397d0a58bc" class="bulleted-list"><li style="list-style-type:disc">Kopiuje dane z wybranego pliku do nowego arkusza w aktywnym skoroszycie.</li></ul><hr id="1a5749eb-6be7-8038-b610-ff04522a04d5"/><h3 id="1a5749eb-6be7-8049-a2a3-d9a7ab066134" class=""><strong>FindColumn(ws, columnName)</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80c6-af54-dd83491b3520" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Function FindColumn(ws As Worksheet, columnName As String) As Integer
</code></pre><ul id="1a5749eb-6be7-8038-800c-c15fa9b9e45a" class="bulleted-list"><li style="list-style-type:disc">Znajduje numer kolumny na podstawie jej nazwy w pierwszym wierszu arkusza.</li></ul><ul id="1a5749eb-6be7-80a2-b8e6-cc2538a8ee41" class="bulleted-list"><li style="list-style-type:disc">Zwraca indeks kolumny lub <code>0</code>, jeśli nie znaleziono.</li></ul><hr id="1a5749eb-6be7-803b-a80f-f8c177e68e49"/><h3 id="1a5749eb-6be7-80d9-83a9-f6c69e18d931" class=""><strong>ConvertToSafeKey(value)</strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5749eb-6be7-80b0-bef5-d01e8a893683" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Function ConvertToSafeKey(value As Variant) As String
</code></pre><ul id="1a5749eb-6be7-80c5-9003-c63213fee61c" class="bulleted-list"><li style="list-style-type:disc">Konwertuje wartość na bezpieczny klucz dla słowników.</li></ul><ul id="1a5749eb-6be7-804f-bbe5-f086b36354f8" class="bulleted-list"><li style="list-style-type:disc">Obsługuje wartości <code>NULL</code> i błędy konwersji.</li></ul><p id="1a5749eb-6be7-80dc-96fe-d8948575ce2f" class="">
</p><p id="1a5749eb-6be7-8002-9abe-eb27105418e3" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>